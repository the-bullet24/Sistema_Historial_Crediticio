--
-- PostgreSQL database dump
--

\restrict d3ma6Jv5Ik5PoDkAyzEKN4D1zghCQ6DZNRcOB6wxZIKK4EWeFEV3NnfnTRHriQv

-- Dumped from database version 18.2
-- Dumped by pg_dump version 18.2

-- Started on 2026-02-22 19:05:10

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 6 (class 2615 OID 16389)
-- Name: core; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA core;


ALTER SCHEMA core OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 223 (class 1259 OID 16449)
-- Name: empresas; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.empresas (
    id bigint NOT NULL,
    ruc character varying(11) NOT NULL,
    razon_social character varying(150) NOT NULL,
    direccion character varying(200),
    rubro character varying(100),
    correo_contacto character varying(150),
    telefono character varying(15) NOT NULL,
    fecha_registro timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    estado character varying(20) DEFAULT 'activo'::character varying
);


ALTER TABLE core.empresas OWNER TO postgres;

--
-- TOC entry 222 (class 1259 OID 16448)
-- Name: empresas_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.empresas_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.empresas_id_seq OWNER TO postgres;

--
-- TOC entry 5015 (class 0 OID 0)
-- Dependencies: 222
-- Name: empresas_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.empresas_id_seq OWNED BY core.empresas.id;


--
-- TOC entry 229 (class 1259 OID 16507)
-- Name: historial_score_empresa; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.historial_score_empresa (
    id bigint NOT NULL,
    empresa_id bigint NOT NULL,
    anio integer NOT NULL,
    mes integer NOT NULL,
    total_transacciones integer,
    transacciones_morosas integer,
    promedio_dias_retraso numeric(5,2),
    score integer NOT NULL,
    clasificacion character varying(20),
    fecha_calculo timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE core.historial_score_empresa OWNER TO postgres;

--
-- TOC entry 228 (class 1259 OID 16506)
-- Name: historial_score_empresa_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.historial_score_empresa_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.historial_score_empresa_id_seq OWNER TO postgres;

--
-- TOC entry 5018 (class 0 OID 0)
-- Dependencies: 228
-- Name: historial_score_empresa_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.historial_score_empresa_id_seq OWNED BY core.historial_score_empresa.id;


--
-- TOC entry 227 (class 1259 OID 16488)
-- Name: pagos; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.pagos (
    id bigint NOT NULL,
    transaccion_id bigint NOT NULL,
    fecha_pago date NOT NULL,
    monto numeric(12,2) NOT NULL,
    metodo_pago character varying(50),
    numero_operacion character varying(100),
    banco character varying(100),
    comprobante_url text,
    fecha_registro timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE core.pagos OWNER TO postgres;

--
-- TOC entry 226 (class 1259 OID 16487)
-- Name: pagos_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.pagos_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.pagos_id_seq OWNER TO postgres;

--
-- TOC entry 5021 (class 0 OID 0)
-- Dependencies: 226
-- Name: pagos_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.pagos_id_seq OWNED BY core.pagos.id;


--
-- TOC entry 232 (class 1259 OID 16536)
-- Name: productos; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.productos (
    id bigint NOT NULL,
    empresa_id bigint NOT NULL,
    nombre character varying(150) NOT NULL,
    descripcion character varying(300),
    precio_unitario numeric(12,2) NOT NULL,
    unidad_medida character varying(50) DEFAULT 'unidad'::character varying NOT NULL,
    stock integer DEFAULT 0 NOT NULL,
    estado character varying(20) DEFAULT 'activo'::character varying NOT NULL,
    fecha_registro timestamp without time zone DEFAULT now()
);


ALTER TABLE core.productos OWNER TO postgres;

--
-- TOC entry 231 (class 1259 OID 16535)
-- Name: productos_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.productos_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.productos_id_seq OWNER TO postgres;

--
-- TOC entry 5024 (class 0 OID 0)
-- Dependencies: 231
-- Name: productos_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.productos_id_seq OWNED BY core.productos.id;


--
-- TOC entry 234 (class 1259 OID 16561)
-- Name: transaccion_detalle; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.transaccion_detalle (
    id bigint NOT NULL,
    transaccion_id bigint NOT NULL,
    producto_id bigint NOT NULL,
    cantidad integer NOT NULL,
    precio_unitario numeric(12,2) NOT NULL,
    subtotal numeric(12,2) GENERATED ALWAYS AS (((cantidad)::numeric * precio_unitario)) STORED
);


ALTER TABLE core.transaccion_detalle OWNER TO postgres;

--
-- TOC entry 233 (class 1259 OID 16560)
-- Name: transaccion_detalle_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.transaccion_detalle_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.transaccion_detalle_id_seq OWNER TO postgres;

--
-- TOC entry 5027 (class 0 OID 0)
-- Dependencies: 233
-- Name: transaccion_detalle_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.transaccion_detalle_id_seq OWNED BY core.transaccion_detalle.id;


--
-- TOC entry 225 (class 1259 OID 16466)
-- Name: transacciones; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.transacciones (
    id bigint NOT NULL,
    empresa_id bigint NOT NULL,
    codigo_transaccion character varying(50) NOT NULL,
    fecha_venta date NOT NULL,
    monto_total numeric(12,2) NOT NULL,
    fecha_vencimiento date NOT NULL,
    estado_pago character varying(20) DEFAULT 'pendiente'::character varying,
    fecha_registro timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE core.transacciones OWNER TO postgres;

--
-- TOC entry 224 (class 1259 OID 16465)
-- Name: transacciones_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.transacciones_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.transacciones_id_seq OWNER TO postgres;

--
-- TOC entry 5030 (class 0 OID 0)
-- Dependencies: 224
-- Name: transacciones_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.transacciones_id_seq OWNED BY core.transacciones.id;


--
-- TOC entry 221 (class 1259 OID 16431)
-- Name: usuarios; Type: TABLE; Schema: core; Owner: postgres
--

CREATE TABLE core.usuarios (
    id bigint NOT NULL,
    nombre character varying(100) NOT NULL,
    email character varying(150) NOT NULL,
    password_hash text NOT NULL,
    rol character varying(50) DEFAULT 'analista'::character varying,
    fecha_creacion timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    estado character varying(20) DEFAULT 'activo'::character varying
);


ALTER TABLE core.usuarios OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 16430)
-- Name: usuarios_id_seq; Type: SEQUENCE; Schema: core; Owner: postgres
--

CREATE SEQUENCE core.usuarios_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE core.usuarios_id_seq OWNER TO postgres;

--
-- TOC entry 5033 (class 0 OID 0)
-- Dependencies: 220
-- Name: usuarios_id_seq; Type: SEQUENCE OWNED BY; Schema: core; Owner: postgres
--

ALTER SEQUENCE core.usuarios_id_seq OWNED BY core.usuarios.id;


--
-- TOC entry 230 (class 1259 OID 16526)
-- Name: v_score_actual; Type: VIEW; Schema: core; Owner: postgres
--

CREATE VIEW core.v_score_actual AS
 SELECT DISTINCT ON (empresa_id) empresa_id,
    anio,
    mes,
    score,
    clasificacion,
    fecha_calculo
   FROM core.historial_score_empresa
  ORDER BY empresa_id, anio DESC, mes DESC;


ALTER VIEW core.v_score_actual OWNER TO postgres;

--
-- TOC entry 4795 (class 2604 OID 16452)
-- Name: empresas id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.empresas ALTER COLUMN id SET DEFAULT nextval('core.empresas_id_seq'::regclass);


--
-- TOC entry 4803 (class 2604 OID 16510)
-- Name: historial_score_empresa id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.historial_score_empresa ALTER COLUMN id SET DEFAULT nextval('core.historial_score_empresa_id_seq'::regclass);


--
-- TOC entry 4801 (class 2604 OID 16491)
-- Name: pagos id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.pagos ALTER COLUMN id SET DEFAULT nextval('core.pagos_id_seq'::regclass);


--
-- TOC entry 4805 (class 2604 OID 16539)
-- Name: productos id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.productos ALTER COLUMN id SET DEFAULT nextval('core.productos_id_seq'::regclass);


--
-- TOC entry 4810 (class 2604 OID 16564)
-- Name: transaccion_detalle id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transaccion_detalle ALTER COLUMN id SET DEFAULT nextval('core.transaccion_detalle_id_seq'::regclass);


--
-- TOC entry 4798 (class 2604 OID 16469)
-- Name: transacciones id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transacciones ALTER COLUMN id SET DEFAULT nextval('core.transacciones_id_seq'::regclass);


--
-- TOC entry 4791 (class 2604 OID 16434)
-- Name: usuarios id; Type: DEFAULT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.usuarios ALTER COLUMN id SET DEFAULT nextval('core.usuarios_id_seq'::regclass);


--
-- TOC entry 4997 (class 0 OID 16449)
-- Dependencies: 223
-- Data for Name: empresas; Type: TABLE DATA; Schema: core; Owner: postgres
--

INSERT INTO core.empresas VALUES (1, '20600000001', 'Comercial Andina SAC', 'Lima', 'Distribución', 'contacto@andina.pe', '987654321', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (2, '20600000002', 'Inversiones Pacífico SRL', 'Arequipa', 'Retail', 'ventas@pacifico.pe', '912345678', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (3, '20600000003', 'Grupo Altiplano SAC', 'Cusco', 'Construcción', 'admin@altiplano.pe', '923456781', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (4, '20600000004', 'Servicios Industriales Norte', 'Trujillo', 'Industrial', 'info@norte.pe', '934567812', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (5, '20600000005', 'Corporación Lima Centro', 'Lima', 'Mayorista', 'contacto@limacentro.pe', '945678123', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (6, '20600000006', 'Distribuidora Sur Andina', 'Tacna', 'Distribución', 'ventas@surandina.pe', '956781234', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (7, '20600000007', 'Importaciones del Perú SAC', 'Callao', 'Importación', 'import@peru.pe', '967812345', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (8, '20600000008', 'Tecnología Empresarial SAC', 'Lima', 'Tecnología', 'soporte@tecemp.pe', '978123456', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (9, '20600000009', 'Alimentos Premium SAC', 'Piura', 'Alimentos', 'ventas@alimentos.pe', '989234567', '2026-02-21 18:48:26.038824', 'activo');
INSERT INTO core.empresas VALUES (10, '20600000010', 'Logística Integral Perú', 'Chiclayo', 'Logística', 'admin@logistica.pe', '990345678', '2026-02-21 18:48:26.038824', 'activo');


--
-- TOC entry 5003 (class 0 OID 16507)
-- Dependencies: 229
-- Data for Name: historial_score_empresa; Type: TABLE DATA; Schema: core; Owner: postgres
--

INSERT INTO core.historial_score_empresa VALUES (1, 1, 2025, 11, 10, 1, 2.50, 88, 'Bajo Riesgo', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (2, 1, 2025, 12, 8, 0, 0.50, 95, 'Excelente', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (3, 1, 2026, 1, 12, 2, 4.00, 76, 'Bajo Riesgo', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (4, 2, 2025, 11, 6, 2, 6.00, 60, 'Riesgo Medio', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (5, 2, 2025, 12, 7, 3, 8.50, 48, 'Riesgo Alto', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (6, 2, 2026, 1, 5, 1, 3.00, 72, 'Riesgo Medio', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (7, 3, 2025, 12, 15, 0, 0.00, 100, 'Excelente', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (8, 3, 2026, 1, 10, 1, 2.00, 90, 'Excelente', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (9, 4, 2026, 1, 9, 4, 10.00, 35, 'Crítico', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (10, 5, 2025, 12, 4, 0, 0.00, 98, 'Excelente', '2026-02-21 18:53:20.909708');
INSERT INTO core.historial_score_empresa VALUES (11, 5, 2026, 1, 6, 1, 1.50, 85, 'Bajo Riesgo', '2026-02-21 18:53:20.909708');


--
-- TOC entry 5001 (class 0 OID 16488)
-- Dependencies: 227
-- Data for Name: pagos; Type: TABLE DATA; Schema: core; Owner: postgres
--

INSERT INTO core.pagos VALUES (1, 1, '2023-04-09', 8000.00, 'Transferencia', 'OP001', 'BCP', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (2, 2, '2024-07-10', 6000.00, 'Transferencia', 'OP002', 'BBVA', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (3, 2, '2024-07-20', 6000.00, 'Transferencia', 'OP003', 'BBVA', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (4, 3, '2025-02-20', 5000.00, 'Transferencia', 'OP004', 'Interbank', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (5, 4, '2025-06-10', 5000.00, 'Transferencia', 'OP005', 'BCP', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (6, 4, '2025-06-25', 5000.00, 'Transferencia', 'OP006', 'BCP', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (7, 4, '2025-07-05', 5000.00, 'Transferencia', 'OP007', 'BCP', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (8, 5, '2026-01-25', 3000.00, 'Transferencia', 'OP008', 'BBVA', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (9, 8, '2024-09-28', 6000.00, 'Transferencia', 'OP009', 'BCP', NULL, '2026-02-21 18:48:38.853962');
INSERT INTO core.pagos VALUES (10, 9, '2023-10-01', 4000.00, 'Transferencia', 'OP010', 'Interbank', NULL, '2026-02-21 18:48:38.853962');


--
-- TOC entry 5005 (class 0 OID 16536)
-- Dependencies: 232
-- Data for Name: productos; Type: TABLE DATA; Schema: core; Owner: postgres
--

INSERT INTO core.productos VALUES (1, 1, 'Arroz Premium 50kg', 'Saco de arroz extra', 85.00, 'saco', 200, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (2, 1, 'Aceite Vegetal 1L', 'Aceite de cocina', 8.50, 'unidad', 500, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (3, 1, 'Azúcar Rubia 50kg', 'Azúcar a granel', 95.00, 'saco', 150, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (4, 2, 'Polo Básico', 'Polo de algodón talla M', 25.00, 'unidad', 300, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (5, 2, 'Pantalón Jean', 'Jean clásico azul', 89.90, 'unidad', 150, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (6, 3, 'Cemento Portland 42kg', 'Bolsa de cemento', 32.00, 'bolsa', 400, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (7, 3, 'Fierro 1/2"', 'Varilla de 9m', 45.00, 'unidad', 200, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (8, 4, 'Tuerca Industrial M10', 'Tuerca de acero', 0.80, 'unidad', 5000, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (9, 4, 'Perno 3/8"', 'Perno galvanizado', 1.20, 'unidad', 3000, 'activo', '2026-02-22 18:18:43.017693');
INSERT INTO core.productos VALUES (10, 5, 'Detergente 15kg', 'Detergente industrial', 75.00, 'balde', 100, 'activo', '2026-02-22 18:18:43.017693');


--
-- TOC entry 5007 (class 0 OID 16561)
-- Dependencies: 234
-- Data for Name: transaccion_detalle; Type: TABLE DATA; Schema: core; Owner: postgres
--



--
-- TOC entry 4999 (class 0 OID 16466)
-- Dependencies: 225
-- Data for Name: transacciones; Type: TABLE DATA; Schema: core; Owner: postgres
--

INSERT INTO core.transacciones VALUES (1, 1, 'TRX-2023-001', '2023-03-10', 8000.00, '2023-04-10', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (2, 1, 'TRX-2024-002', '2024-06-15', 12000.00, '2024-07-15', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (3, 2, 'TRX-2025-003', '2025-01-05', 5000.00, '2025-02-05', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (4, 3, 'TRX-2025-004', '2025-05-20', 15000.00, '2025-06-20', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (5, 4, 'TRX-2026-005', '2026-01-01', 7000.00, '2026-02-01', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (6, 5, 'TRX-2026-006', '2026-01-10', 9000.00, '2026-02-10', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (7, 6, 'TRX-2026-007', '2026-01-15', 11000.00, '2026-02-15', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (8, 7, 'TRX-2024-008', '2024-09-01', 6000.00, '2024-10-01', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (9, 8, 'TRX-2023-009', '2023-08-12', 4000.00, '2023-09-12', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (10, 9, 'TRX-2025-010', '2025-03-03', 13000.00, '2025-04-03', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (11, 2, 'TRX-2026-011', '2026-01-05', 7500.00, '2026-02-05', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (12, 3, 'TRX-2024-012', '2024-02-10', 9500.00, '2024-03-10', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (13, 4, 'TRX-2023-013', '2023-11-01', 3000.00, '2023-12-01', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (14, 8, 'TRX-2026-014', '2026-01-20', 20000.00, '2026-02-20', 'pendiente', '2026-02-21 18:48:33.648733');
INSERT INTO core.transacciones VALUES (15, 10, 'TRX-2025-015', '2025-07-07', 10000.00, '2025-08-07', 'pendiente', '2026-02-21 18:48:33.648733');


--
-- TOC entry 4995 (class 0 OID 16431)
-- Dependencies: 221
-- Data for Name: usuarios; Type: TABLE DATA; Schema: core; Owner: postgres
--



--
-- TOC entry 5036 (class 0 OID 0)
-- Dependencies: 222
-- Name: empresas_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.empresas_id_seq', 10, true);


--
-- TOC entry 5037 (class 0 OID 0)
-- Dependencies: 228
-- Name: historial_score_empresa_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.historial_score_empresa_id_seq', 11, true);


--
-- TOC entry 5038 (class 0 OID 0)
-- Dependencies: 226
-- Name: pagos_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.pagos_id_seq', 10, true);


--
-- TOC entry 5039 (class 0 OID 0)
-- Dependencies: 231
-- Name: productos_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.productos_id_seq', 10, true);


--
-- TOC entry 5040 (class 0 OID 0)
-- Dependencies: 233
-- Name: transaccion_detalle_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.transaccion_detalle_id_seq', 1, false);


--
-- TOC entry 5041 (class 0 OID 0)
-- Dependencies: 224
-- Name: transacciones_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.transacciones_id_seq', 15, true);


--
-- TOC entry 5042 (class 0 OID 0)
-- Dependencies: 220
-- Name: usuarios_id_seq; Type: SEQUENCE SET; Schema: core; Owner: postgres
--

SELECT pg_catalog.setval('core.usuarios_id_seq', 1, false);


--
-- TOC entry 4817 (class 2606 OID 16462)
-- Name: empresas empresas_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.empresas
    ADD CONSTRAINT empresas_pkey PRIMARY KEY (id);


--
-- TOC entry 4819 (class 2606 OID 16464)
-- Name: empresas empresas_ruc_key; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.empresas
    ADD CONSTRAINT empresas_ruc_key UNIQUE (ruc);


--
-- TOC entry 4827 (class 2606 OID 16518)
-- Name: historial_score_empresa historial_score_empresa_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.historial_score_empresa
    ADD CONSTRAINT historial_score_empresa_pkey PRIMARY KEY (id);


--
-- TOC entry 4825 (class 2606 OID 16500)
-- Name: pagos pagos_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.pagos
    ADD CONSTRAINT pagos_pkey PRIMARY KEY (id);


--
-- TOC entry 4835 (class 2606 OID 16554)
-- Name: productos productos_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.productos
    ADD CONSTRAINT productos_pkey PRIMARY KEY (id);


--
-- TOC entry 4839 (class 2606 OID 16572)
-- Name: transaccion_detalle transaccion_detalle_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transaccion_detalle
    ADD CONSTRAINT transaccion_detalle_pkey PRIMARY KEY (id);


--
-- TOC entry 4821 (class 2606 OID 16481)
-- Name: transacciones transacciones_codigo_transaccion_key; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transacciones
    ADD CONSTRAINT transacciones_codigo_transaccion_key UNIQUE (codigo_transaccion);


--
-- TOC entry 4823 (class 2606 OID 16479)
-- Name: transacciones transacciones_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transacciones
    ADD CONSTRAINT transacciones_pkey PRIMARY KEY (id);


--
-- TOC entry 4831 (class 2606 OID 16520)
-- Name: historial_score_empresa unique_empresa_periodo; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.historial_score_empresa
    ADD CONSTRAINT unique_empresa_periodo UNIQUE (empresa_id, anio, mes);


--
-- TOC entry 4813 (class 2606 OID 16447)
-- Name: usuarios usuarios_email_key; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.usuarios
    ADD CONSTRAINT usuarios_email_key UNIQUE (email);


--
-- TOC entry 4815 (class 2606 OID 16445)
-- Name: usuarios usuarios_pkey; Type: CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.usuarios
    ADD CONSTRAINT usuarios_pkey PRIMARY KEY (id);


--
-- TOC entry 4828 (class 1259 OID 16530)
-- Name: idx_historial_empresa; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_historial_empresa ON core.historial_score_empresa USING btree (empresa_id);


--
-- TOC entry 4829 (class 1259 OID 16531)
-- Name: idx_historial_periodo; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_historial_periodo ON core.historial_score_empresa USING btree (anio, mes);


--
-- TOC entry 4832 (class 1259 OID 16583)
-- Name: idx_productos_empresa_id; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_productos_empresa_id ON core.productos USING btree (empresa_id);


--
-- TOC entry 4833 (class 1259 OID 16584)
-- Name: idx_productos_estado; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_productos_estado ON core.productos USING btree (estado);


--
-- TOC entry 4836 (class 1259 OID 16586)
-- Name: idx_transaccion_detalle_prod; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_transaccion_detalle_prod ON core.transaccion_detalle USING btree (producto_id);


--
-- TOC entry 4837 (class 1259 OID 16585)
-- Name: idx_transaccion_detalle_trx; Type: INDEX; Schema: core; Owner: postgres
--

CREATE INDEX idx_transaccion_detalle_trx ON core.transaccion_detalle USING btree (transaccion_id);


--
-- TOC entry 4840 (class 2606 OID 16482)
-- Name: transacciones fk_empresa; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transacciones
    ADD CONSTRAINT fk_empresa FOREIGN KEY (empresa_id) REFERENCES core.empresas(id) ON DELETE CASCADE;


--
-- TOC entry 4842 (class 2606 OID 16521)
-- Name: historial_score_empresa fk_empresa_score; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.historial_score_empresa
    ADD CONSTRAINT fk_empresa_score FOREIGN KEY (empresa_id) REFERENCES core.empresas(id) ON DELETE CASCADE;


--
-- TOC entry 4841 (class 2606 OID 16501)
-- Name: pagos fk_transaccion; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.pagos
    ADD CONSTRAINT fk_transaccion FOREIGN KEY (transaccion_id) REFERENCES core.transacciones(id) ON DELETE CASCADE;


--
-- TOC entry 4843 (class 2606 OID 16555)
-- Name: productos productos_empresa_id_fkey; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.productos
    ADD CONSTRAINT productos_empresa_id_fkey FOREIGN KEY (empresa_id) REFERENCES core.empresas(id);


--
-- TOC entry 4844 (class 2606 OID 16578)
-- Name: transaccion_detalle transaccion_detalle_producto_id_fkey; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transaccion_detalle
    ADD CONSTRAINT transaccion_detalle_producto_id_fkey FOREIGN KEY (producto_id) REFERENCES core.productos(id);


--
-- TOC entry 4845 (class 2606 OID 16573)
-- Name: transaccion_detalle transaccion_detalle_transaccion_id_fkey; Type: FK CONSTRAINT; Schema: core; Owner: postgres
--

ALTER TABLE ONLY core.transaccion_detalle
    ADD CONSTRAINT transaccion_detalle_transaccion_id_fkey FOREIGN KEY (transaccion_id) REFERENCES core.transacciones(id);


--
-- TOC entry 5013 (class 0 OID 0)
-- Dependencies: 6
-- Name: SCHEMA core; Type: ACL; Schema: -; Owner: postgres
--

GRANT ALL ON SCHEMA core TO score_user;


--
-- TOC entry 5014 (class 0 OID 0)
-- Dependencies: 223
-- Name: TABLE empresas; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.empresas TO score_user;


--
-- TOC entry 5016 (class 0 OID 0)
-- Dependencies: 222
-- Name: SEQUENCE empresas_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON SEQUENCE core.empresas_id_seq TO score_user;


--
-- TOC entry 5017 (class 0 OID 0)
-- Dependencies: 229
-- Name: TABLE historial_score_empresa; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.historial_score_empresa TO score_user;


--
-- TOC entry 5019 (class 0 OID 0)
-- Dependencies: 228
-- Name: SEQUENCE historial_score_empresa_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON SEQUENCE core.historial_score_empresa_id_seq TO score_user;


--
-- TOC entry 5020 (class 0 OID 0)
-- Dependencies: 227
-- Name: TABLE pagos; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.pagos TO score_user;


--
-- TOC entry 5022 (class 0 OID 0)
-- Dependencies: 226
-- Name: SEQUENCE pagos_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON SEQUENCE core.pagos_id_seq TO score_user;


--
-- TOC entry 5023 (class 0 OID 0)
-- Dependencies: 232
-- Name: TABLE productos; Type: ACL; Schema: core; Owner: postgres
--

GRANT SELECT,INSERT,DELETE,UPDATE ON TABLE core.productos TO score_user;


--
-- TOC entry 5025 (class 0 OID 0)
-- Dependencies: 231
-- Name: SEQUENCE productos_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT SELECT,USAGE ON SEQUENCE core.productos_id_seq TO score_user;


--
-- TOC entry 5026 (class 0 OID 0)
-- Dependencies: 234
-- Name: TABLE transaccion_detalle; Type: ACL; Schema: core; Owner: postgres
--

GRANT SELECT,INSERT,DELETE,UPDATE ON TABLE core.transaccion_detalle TO score_user;


--
-- TOC entry 5028 (class 0 OID 0)
-- Dependencies: 233
-- Name: SEQUENCE transaccion_detalle_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT SELECT,USAGE ON SEQUENCE core.transaccion_detalle_id_seq TO score_user;


--
-- TOC entry 5029 (class 0 OID 0)
-- Dependencies: 225
-- Name: TABLE transacciones; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.transacciones TO score_user;


--
-- TOC entry 5031 (class 0 OID 0)
-- Dependencies: 224
-- Name: SEQUENCE transacciones_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON SEQUENCE core.transacciones_id_seq TO score_user;


--
-- TOC entry 5032 (class 0 OID 0)
-- Dependencies: 221
-- Name: TABLE usuarios; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.usuarios TO score_user;


--
-- TOC entry 5034 (class 0 OID 0)
-- Dependencies: 220
-- Name: SEQUENCE usuarios_id_seq; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON SEQUENCE core.usuarios_id_seq TO score_user;


--
-- TOC entry 5035 (class 0 OID 0)
-- Dependencies: 230
-- Name: TABLE v_score_actual; Type: ACL; Schema: core; Owner: postgres
--

GRANT ALL ON TABLE core.v_score_actual TO score_user;


--
-- TOC entry 2087 (class 826 OID 16534)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: core; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA core GRANT SELECT,INSERT,DELETE,UPDATE ON TABLES TO score_user;


-- Completed on 2026-02-22 19:05:10

--
-- PostgreSQL database dump complete
--

\unrestrict d3ma6Jv5Ik5PoDkAyzEKN4D1zghCQ6DZNRcOB6wxZIKK4EWeFEV3NnfnTRHriQv

